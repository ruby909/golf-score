<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>115å¹´æ˜¥å­£è³½-æœ€çµ‚ä¿®å¾©ç‰ˆ</title>
    <style>
        :root { --primary: #2d5a27; --accent: #d32f2f; }
        body { font-family: -apple-system, sans-serif; background: #f0f2f0; margin: 0; padding: 5px; }
        .container { background: white; border-radius: 8px; padding: 5px; max-width: 650px; margin: auto; }
        .header h1 { font-size: 18px; color: var(--primary); text-align: center; margin: 10px 0; }
        .action-bar { position: sticky; top: 0; z-index: 100; background: white; padding: 10px 0; display: flex; justify-content: center; gap: 5px; border-bottom: 1px solid #ddd; }
        .btn { padding: 8px 12px; font-size: 14px; border-radius: 15px; border: none; color: white; font-weight: bold; cursor: pointer; }
        .btn-rank { background: var(--accent); }
        .btn-print { background: #1976d2; }
        
        table { width: 100%; border-collapse: collapse; table-layout: fixed; }
        th { background: var(--primary); color: white; padding: 5px 2px; font-size: 12px; }
        td { border-bottom: 1px solid #eee; padding: 6px 2px; text-align: center; vertical-align: middle; }
        
        /* å¯¬åº¦æ§åˆ¶ */
        .col-rank { width: 30px; }
        .col-info { width: 75px; text-align: left; padding-left: 2px; }
        .col-score { width: 50px; }
        .col-total { width: 40px; }
        
        .name-text { font-size: 14px; font-weight: bold; display: block; white-space: nowrap; }
        .sub-info { font-size: 10px; color: #666; display: block; line-height: 1.2; }
        input[type="number"] { width: 44px; height: 32px; border: 1px solid #ccc; border-radius: 4px; text-align: center; font-size: 17px; }
        .total-cell { font-weight: bold; color: var(--accent); font-size: 15px; }
        .print-val { display: none; }

        @media print {
            .no-print, .action-bar, .btn-clear { display: none !important; }
            .print-val { display: inline !important; font-weight: bold; }
            input { display: none !important; }
            table { width: 100%; table-layout: auto; border: 2px solid #000; }
            th, td { border: 1px solid #000; font-size: 12px; padding: 4px; color: black !important; }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header"><h1>â›³ 115 å¹´æ˜¥å­£æœƒå…§è³½æˆç¸¾è¡¨</h1></div>
    <div class="action-bar no-print">
        <button class="btn btn-rank" onclick="calculateRank()">ğŸ“Š è¨ˆç®—æ’å</button>
        <button class="btn btn-print" onclick="handlePrint()">ğŸ–¨ï¸ åªå°å®Œè³½è€…</button>
        <button style="background:#757575" class="btn" onclick="clearData()">ğŸ—‘ï¸ æ¸…ç©º</button>
    </div>
    <table id="mainTable">
        <thead>
            <tr>
                <th class="col-rank">åæ¬¡</th>
                <th class="col-info">é¸æ‰‹</th>
                <th class="col-score">çƒ1</th>
                <th class="col-score">çƒ2</th>
                <th class="col-total">ç¸½åˆ†</th>
                <th class="col-score">HIO</th>
            </tr>
        </thead>
        <tbody id="tableBody"></tbody>
    </table>
</div>

<script>
    // åš´æ ¼æ ¡å°åå–® - ç¢ºä¿ç„¡æ ¼å¼éŒ¯èª¤
    const players = [
        {name:"é™³æµ©è¯", bday:"39.12.21", group:"1-1"}, {name:"é»ƒéº—å¿", bday:"33.11.28", group:"1-2"}, {name:"æé¦™è˜­", bday:"39.12.30", group:"1-3"}, {name:"æ¶‚é‡‘è‘‰", bday:"36.08.17", group:"1-4"}, {name:"é»ƒä¸€æ–‡", bday:"44.12.18", group:"1-5"}, {name:"è‘›ä¿®ç«‹", bday:"41.07.26", group:"1-6"}, {name:"ç‹åœ‹æ˜", bday:"49.11.29", group:"1-7"}, {name:"æº«ä¸‰éƒ", bday:"30.09.02", group:"1-8"},
        {name:"å¤æ·‘å®š", bday:"50.02.04", group:"2-1"}, {name:"å¾å¯Œç¾", bday:"34.07.08", group:"2-2"}, {name:"æ—è‚²å ‚", bday:"51.01.17", group:"2-3"}, {name:"ææ—¥ä¼¸", bday:"43.06.05", group:"2-4"}, {name:"å‘¨æ­£çª“", bday:"46.12.06", group:"2-5"}, {name:"å³éŠ˜å±•", bday:"50.04.09", group:"2-6"}, {name:"é™³é‘¾é³³", bday:"36.02.02", group:"2-7"}, {name:"é«˜ç§€è˜­", bday:"37.04.08", group:"2-8"},
        {name:"å¤æ·‘ç", bday:"40.01.26", group:"3-1"}, {name:"å¤æ–‡å¿ ", bday:"47.07.26", group:"3-2"}, {name:"è³´å»ºäº¨", bday:"41.12.18", group:"3-3"}, {name:"æŸ¯é‡é›„", bday:"30.03.20", group:"3-4"}, {name:"é‚±æ¸…æº", bday:"48.10.10", group:"3-5"}, {name:"è”¡éº—ç¥", bday:"52.09.15", group:"3-6"}, {name:"å³å¿ æ”¿", bday:"60.03.23", group:"3-7"}, {name:"è”¡æŒ¯é›„", bday:"41.04.27", group:"3-8"},
        {name:"æ´ªè‚‡æ¼¢", bday:"47.05.01", group:"4-1"}, {name:"å»–ä¹ç´…", bday:"36.10.07", group:"4-2"}, {name:"é„­æœ¨é›„", bday:"46.01.11", group:"4-3"}, {name:"æ—é †èª ", bday:"44.11.15", group:"4-4"}, {name:"ç‹æŸæ¬½", bday:"58.11.16", group:"4-5"}, {name:"é‚±æ†¶è", bday:"57.02.13", group:"4-6"}, {name:"ç‹é™³æˆ", bday:"49.09.17", group:"4-7"}, {name:"é»ƒä¸–è³¢", bday:"41.11.13", group:"4-8"},
        {name:"ç°¡ç‘èŒ‚", bday:"50.12.02", group:"5-1"}, {name:"ç‰›å·½åº·", bday:"38.02.21", group:"5-2"}, {name:"æ—ç§€ç¾", bday:"49.11.10", group:"5-3"}, {name:"ç‹ç±³å‰", bday:"31.03.01", group:"5-4"}, {name:"é»ƒæ­£å¿ ", bday:"49.12.08", group:"5-5"}, {name:"æ—ç§€å¨Ÿ", bday:"56.09.04", group:"5-6"}, {name:"æ±Ÿæ˜èŠ³", bday:"43.11.16", group:"5-7"}, {name:"ç°¡è°æ˜", bday:"42.09.04", group:"5-8"},
        {name:"è·¯æµ·å°", bday:"40.05.20", group:"6-1"}, {name:"æ—é‡‘æœ", bday:"36.08.27", group:"6-2"}, {name:"èŠç™»ç« ", bday:"39.08.28", group:"6-3"}, {name:"ç‹æéº—å¿", bday:"39.06.30", group:"6-4"}, {name:"å¼µå”å¾·", bday:"39.08.12", group:"6-5"}, {name:"è©¹ç‡•æ²»", bday:"39.12.10", group:"6-6"}, {name:"é™³ å’Œ", bday:"26.02.22", group:"6-7"}, {name:"ç‹æ˜å±±", bday:"35.04.20", group:"6-8"},
        {name:"é—•ç¢§æ¢…", bday:"48.09.21", group:"7-1"}, {name:"æ±Ÿéº—ç ", bday:"35.07.25", group:"7-2"}, {name:"é™³ç¢§ç ", bday:"47.12.21", group:"7-3"}, {name:"è¨±å¿—ç”·", bday:"45.12.09", group:"7-4"}, {name:"é™³æ°‘ç”Ÿ", bday:"42.10.06", group:"7-5"}, {name:"æ±Ÿè¾°é›„", bday:"34.01.16", group:"7-6"}, {name:"é‚±é‡‘ç”Ÿ", bday:"47.04.28", group:"7-7"}, {name:"é™³ çµ²", bday:"31.03.21", group:"7-8"},
        {name:"éƒ­å»ºèˆˆ", bday:"38.03.18", group:"8-1"}, {name:"éƒ­å¬Œ", bday:"44.10.10", group:"8-2"}, {name:"å‚…å…ƒé‡‘", bday:"34.11.01", group:"8-3"}, {name:"åˆ© æ¢…", bday:"30.10.06", group:"8-4"}, {name:"æ—éŒ¦äº®", bday:"47.05.20", group:"8-5"}, {name:"è‘£åœ‹ä¿Š", bday:"39.12.31", group:"8-6"}, {name:"å³æ²›æŸ”", bday:"41.05.01", group:"8-7"}, {name:"æç´ æƒ ", bday:"46.11.05", group:"8-8"},
        {name:"æ¸¸æŒ¯é´»", bday:"40.10.13", group:"9-1"}, {name:"å‚…èŠ³ç´³", bday:"28.09.26", group:"9-2"}, {name:"å‚…åŠ‰èŠé¦™", bday:"36.07.06", group:"9-3"}, {name:"é»ƒå…¨ç”°", bday:"39.09.10", group:"9-4"}, {name:"é»ƒæ¸…æ±Ÿ", bday:"49.08.23", group:"9-5"}, {name:"å»–ç¾èŠ¬", bday:"51.12.22", group:"9-6"}, {name:"ç‹æ¦®åŠ©", bday:"31.12.03", group:"9-7"}, {name:"æ¥Šæ–‡ç¥¥", bday:"46.05.23", group:"9-8"},
        {name:"å¼µæƒ çœŸ", bday:"45.07.24", group:"10-1"}, {name:"é«˜æ–‡é´»", bday:"40.01.15", group:"10-2"}, {name:"å¼µæœˆç´", bday:"45.12.12", group:"10-3"}, {name:"å‘‚çŠé›²", bday:"43.05.15", group:"10-4"}, {name:"çŸ³æ··ç”Ÿ", bday:"34.04.01", group:"10-5"}, {name:"é»ƒå­¸ç”²", bday:"47.04.01", group:"10-6"}, {name:"å‘‚éŠ˜å®¸", bday:"43.08.01", group:"10-7"}, {name:"å¼µæ˜ä»", bday:"40.02.02", group:"10-8"},
        {name:"é»ƒèŒ‚æ¨Ÿ", bday:"40.09.26", group:"11-1"}, {name:"é™³é‡‘é‘¾", bday:"43.03.10", group:"11-2"}, {name:"é»ƒ æ˜¥", bday:"61.02.13", group:"11-3"}, {name:"é¾å¯¶å¦¹", bday:"50.10.19", group:"11-4"}, {name:"é—•é‡‘å¡—", bday:"51.07.27", group:"11-5"}, {name:"å³ä¾†æ—º", bday:"33.11.06", group:"11-6"}, {name:"æ›¾å¬Œç", bday:"36.05.24", group:"11-7"}, {name:"å³ç››å¤", bday:"36.12.01", group:"11-8"},
        {name:"å»–é€²å¿ ", bday:"38.06.30", group:"12-1"}, {name:"å»– è€", bday:"44.11.08", group:"12-2"}, {name:"å­«æ­¦å¾©", bday:"36.01.10", group:"12-3"}, {name:"å³æŸæ¯…", bday:"45.01.05", group:"12-4"}, {name:"é™³é¾æ–‡", bday:"39.08.14", group:"12-5"}, {name:"å§œå½©èŠ±", bday:"49.10.19", group:"12-6"}, {name:"ææ­£å–œ", bday:"30.09.05", group:"12-7"}, {name:"é€£å¯¬ä»", bday:"32.06.03", group:"12-8"}
    ];

    const STORE_KEY = 'golf_vFinal_Print';

    function init() {
        const tbody = document.getElementById('tableBody');
        tbody.innerHTML = '';
        const saved = JSON.parse(localStorage.getItem(STORE_KEY) || '{}');
        
        players.forEach(p => {
            const key = p.name + p.group;
            const d = saved[key] || {s1:'', s2:'', hio:0};
            const row = document.createElement('tr');
            row.setAttribute('data-bday', p.bday);
            row.setAttribute('data-key', key);
            row.innerHTML = `
                <td class="rank-cell">-</td>
                <td class="col-info">
                    <span class="name-text">${p.name}</span>
                    <span class="sub-info">${p.group} | ${p.bday}</span>
                </td>
                <td><input type="number" class="s1" value="${d.s1}" oninput="sv(this);sum(this);nx(this)"><span class="print-val s1-v">${d.s1}</span></td>
                <td><input type="number" class="s2" value="${d.s2}" oninput="sv(this);sum(this);nx(this)"><span class="print-val s2-v">${d.s2}</span></td>
                <td class="total-cell">-</td>
                <td><input type="number" class="hio" value="${d.hio}" oninput="sv(this)"><span class="print-val hio-v">${d.hio}</span></td>
            `;
            tbody.appendChild(row);
            sum(row.querySelector('.s1'));
        });
    }

    function sv(el) {
        const r = el.closest('tr');
        const s = JSON.parse(localStorage.getItem(STORE_KEY) || '{}');
        s[r.getAttribute('data-key')] = {
            s1: r.querySelector('.s1').value,
            s2: r.querySelector('.s2').value,
            hio: r.querySelector('.hio').value
        };
        localStorage.setItem(STORE_KEY, JSON.stringify(s));
    }

    function nx(el) { if(el.value.length >= 2 && el.classList.contains('s1')) el.closest('tr').querySelector('.s2').focus(); }

    function sum(el) {
        const r = el.closest('tr');
        const t = (parseInt(r.querySelector('.s1').value)||0) + (parseInt(r.querySelector('.s2').value)||0);
        r.querySelector('.total-cell').innerText = t > 0 ? t : "-";
    }

    function calculateRank() {
        const rs = Array.from(document.querySelectorAll('#tableBody tr'));
        const dt = rs.map(r => {
            const s1 = r.querySelector('.s1').value;
            const s2 = r.querySelector('.s2').value;
            const t = (parseInt(s1)||0) + (parseInt(s2)||0);
            const isDNF = (s1 === '' || s2 === '');
            
            r.querySelector('.s1-v').innerText = s1;
            r.querySelector('.s2-v').innerText = s2;
            r.querySelector('.hio-v').innerText = r.querySelector('.hio').value;

            return { r, t: isDNF ? 99999 : t, h: parseInt(r.querySelector('.hio').value)||0, b: r.getAttribute('data-bday'), isDNF };
        });

        dt.sort((a,b) => a.t - b.t || b.h - a.h || a.b.localeCompare(b.b));
        
        const b = document.getElementById('tableBody');
        b.innerHTML = '';
        dt.forEach((it, i) => {
            it.r.querySelector('.rank-cell').innerText = it.isDNF ? "-" : (i+1);
            b.appendChild(it.r);
        });
        return dt;
    }

    function handlePrint() {
        const dt = calculateRank();
        const tbody = document.getElementById('tableBody');
        
        // éæ¿¾åªç•™ä¸‹æœ‰æˆç¸¾çš„äºº
        const finished = dt.filter(it => !it.isDNF);
        if(finished.length === 0) return alert("å°šæœªè¼¸å…¥ä»»ä½•æˆç¸¾");

        // å‚™ä»½åŸå§‹æ‰€æœ‰è¡Œ
        const allRows = Array.from(tbody.querySelectorAll('tr'));
        
        // ç•«é¢ä¸Šåªç•™å®Œè³½è€…
        tbody.innerHTML = '';
        finished.forEach(it => tbody.appendChild(it.r));

        window.print();

        // åˆ—å°å®Œç•¢å¾Œï¼Œæ¢å¾©é¡¯ç¤ºæ‰€æœ‰é¸æ‰‹ï¼Œè®“ä½¿ç”¨è€…ç¹¼çºŒè¼¸å…¥
        setTimeout(() => {
            tbody.innerHTML = '';
            allRows.forEach(row => tbody.appendChild(row));
        }, 500);
    }

    function clearData() { if(confirm("ç¢ºå®šæ¸…ç©ºæ‰€æœ‰åˆ†æ•¸ï¼Ÿ")) { localStorage.removeItem(STORE_KEY); location.reload(); } }

    init();
</script>
</body>
</html>